## Objetivo
Corrigir vulnerabilidades críticas de concorrência (Race Conditions), otimizar o desempenho do MongoDB (índices ausentes) e fortalecer o tratamento de erros e logs no sistema de economia e eventos.

## Plano de Ação

### 1. Correção de Race Conditions e Transações (`ComandosSlash/Economia/mercadonegro.js`)
- **Problema:** Uso de `u.save()` para atualizar reputação, heat e inventário sobrescreve dados em concorrência.
- **Solução:** Substituir `u.save()` por `findOneAndUpdate` com operadores atômicos (`$inc`, `$set`, `$push`).
- **Verificação de Estoque Atômica:** Mover a checagem de estoque para dentro do filtro do `updateOne` (ex: `stock: { $gte: qty }`) para garantir que o item só seja debitado se existir no momento da transação.

### 2. Otimização de Índices MongoDB (`Database/blackMarketUser.js`)
- **Problema:** O ranking do Mercado Negro ordena por `stats.criminalProfit` sem índice, causando lentidão (Collection Scan).
- **Solução:** Adicionar índice composto `{ guildID: 1, "stats.criminalProfit": -1 }` no Schema.

### 3. Tratamento de Erros e Logs (`Eventos/guild/messageCreate.js` e outros)
- **Problema:** Erros de banco de dados são silenciados (`.catch(() => {})`).
- **Solução:** Adicionar logs estruturados via `logger.error` nos blocos `catch` críticos para monitoramento.

### 4. Remoção de Segredos Hardcoded (`ComandosSlash/Economia/mercado.js`)
- **Problema:** ID de dono fixo no código.
- **Solução:** Mover ID para `Config.json` ou variável de ambiente.

## Etapas de Execução
1. **Database:** Atualizar `blackMarketUser.js` com os índices necessários.
2. **Refatoração:** Reescrever lógica de compra/venda em `mercadonegro.js` para usar operações atômicas.
3. **Segurança:** Auditar e limpar IDs fixos em `mercado.js`.
4. **Validação:** Rodar testes manuais de compra concorrente (simulada) e verificar logs de erro.

Começarei pela otimização do Banco de Dados e depois focarei na correção crítica de concorrência no `mercadonegro.js`.